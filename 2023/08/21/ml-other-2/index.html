<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>
<meta name="description" content="Sampling  Common Down-sampling Methods Sampling without replacement, in which a subset of the observations are selected randomly, and once an observation is selected it cannot be selected again. Samp">
<meta property="og:type" content="article">
<meta property="og:title" content="Other Things about ML - 2">
<meta property="og:url" content="http://example.com/2023/08/21/ml-other-2/index.html">
<meta property="og:site_name" content="Kelly H">
<meta property="og:description" content="Sampling  Common Down-sampling Methods Sampling without replacement, in which a subset of the observations are selected randomly, and once an observation is selected it cannot be selected again. Samp">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2023/08/21/ml-other-2/smote.png">
<meta property="og:image" content="http://example.com/2023/08/21/ml-other-2/hnsw1.jpg">
<meta property="og:image" content="http://example.com/2023/08/21/ml-other-2/hnsw2.png">
<meta property="article:published_time" content="2023-08-21T20:35:21.000Z">
<meta property="article:modified_time" content="2023-10-01T00:29:51.834Z">
<meta property="article:author" content="KellyH">
<meta property="article:tag" content="machine learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/08/21/ml-other-2/smote.png">


<link rel="canonical" href="http://example.com/2023/08/21/ml-other-2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2023/08/21/ml-other-2/","path":"2023/08/21/ml-other-2/","title":"Other Things about ML - 2"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Other Things about ML - 2 | Kelly H</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Kelly H</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">5</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">5</span></a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#sampling"><span class="nav-number">1.</span> <span class="nav-text"> Sampling</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#common-down-sampling-methods"><span class="nav-number">1.1.</span> <span class="nav-text"> Common Down-sampling Methods</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#upsamplingoversampling"><span class="nav-number">1.2.</span> <span class="nav-text"> Upsampling&#x2F;Oversampling</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#smote-synthetic-minority-oversampling-technique"><span class="nav-number">1.2.1.</span> <span class="nav-text"> SMOTE (Synthetic Minority Oversampling Technique)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ann-approximate-nearest-neighbor"><span class="nav-number">2.</span> <span class="nav-text"> ANN (approximate nearest neighbor)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#tree-based-kd-tree"><span class="nav-number">2.1.</span> <span class="nav-text"> Tree-based: Kd-tree</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hash-based-lsh"><span class="nav-number">2.2.</span> <span class="nav-text"> Hash-based: LSH</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#graph-based-hnsw"><span class="nav-number">2.3.</span> <span class="nav-text"> Graph-based: HNSW</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#nsw"><span class="nav-number">2.3.1.</span> <span class="nav-text"> NSW</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hnsw"><span class="nav-number">2.3.2.</span> <span class="nav-text"> HNSW</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#k-fold-cross-validation"><span class="nav-number">3.</span> <span class="nav-text"> K-Fold Cross Validation</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">KellyH</p>
  <div class="site-description" itemprop="description">Machine Learning Engineer <br> Share & Learn</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:kelly.hejiale@gmail.com" title="E-Mail → mailto:kelly.hejiale@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/kellyhe-jiale/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;kellyhe-jiale&#x2F;" rel="noopener" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>Linkedin</a>
      </span>
  </div>



          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/08/21/ml-other-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="KellyH">
      <meta itemprop="description" content="Machine Learning Engineer <br> Share & Learn">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kelly H">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Other Things about ML - 2
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2023-09-30 17:29:51" itemprop="dateModified" datetime="2023-09-30T17:29:51-07:00">2023-09-30</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technical/" itemprop="url" rel="index"><span itemprop="name">technical</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/technical/machine-learning-notes/" itemprop="url" rel="index"><span itemprop="name">machine learning notes</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="sampling"><a class="markdownIt-Anchor" href="#sampling"></a> Sampling</h1>
<h2 id="common-down-sampling-methods"><a class="markdownIt-Anchor" href="#common-down-sampling-methods"></a> Common Down-sampling Methods</h2>
<p><strong>Sampling without replacement</strong><a name = "sample_wo_replacement"></a>, in which a subset of the observations are selected randomly, and once an observation is selected it cannot be selected again.<br />
<strong>Sampling with replacement</strong>, in which a subset of observations are selected randomly, and an observation may be selected more than once.</p>
<p>If we have <code>m</code> samples, and we do this sampling for <code>m</code> times, after choosing one item, we put it back. Then the sample size would be 63.2% of the original set.</p>
<p>Math details:<br />
The probability of not being chosen is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">1 - \frac{1}{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, so the probability of not chosen after <code>m</code> times is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msup><mo stretchy="false">)</mo><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">(1 - \frac{1}{m})^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span>, if <code>m</code> is large enough, then we have:</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mo><mi>lim</mi><mo>⁡</mo></mo><mrow><mi>m</mi><mo>→</mo><mi mathvariant="normal">∞</mi></mrow></munder><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msup><mo stretchy="false">)</mo><mi>m</mi></msup><mo>=</mo><mfrac><mn>1</mn><mi>e</mi></mfrac><mo>≈</mo><mn>0.368</mn></mrow><annotation encoding="application/x-tex">\lim_{m \to \infty} (1 - \frac{1}{m})^m = \frac{1}{e} \approx 0.368
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.45em;vertical-align:-0.7em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.1em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mrel mtight">→</span><span class="mord mtight">∞</span></span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">6</span><span class="mord">8</span></span></span></span></span></p>
<p><strong>Selecting a stratified sample</strong>, in which a subset of observations are selected randomly from each group of the observations defined by the value of a stratifying variable, and once an observation is selected it cannot be selected again.</p>
<h2 id="upsamplingoversampling"><a class="markdownIt-Anchor" href="#upsamplingoversampling"></a> Upsampling/Oversampling</h2>
<h3 id="smote-synthetic-minority-oversampling-technique"><a class="markdownIt-Anchor" href="#smote-synthetic-minority-oversampling-technique"></a> SMOTE (Synthetic Minority Oversampling Technique)</h3>
<p>Synthesize samples for the minority class.</p>
<p>Assume we need to oversample by N, then the steps are:</p>
<ol>
<li>Select 1 minority sample and find its knn.</li>
<li>Randomly choose N nodes from k neighbors.</li>
<li>Interpolate the new synthetic sample.</li>
<li>Repeat 1-3 for all samples in minority class.</li>
</ol>
<p>Interpolate as follows:</p>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/2023/08/21/ml-other-2/smote.png" alt="" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">SMOTE</td>
</tr>
</tbody>
</table>
<p>Node <code>C</code> is synthesized based on the difference between node <code>A</code> and node <code>B</code>. The synthetic nodes are always in the same direction of its base nodes.</p>
<h1 id="ann-approximate-nearest-neighbor"><a class="markdownIt-Anchor" href="#ann-approximate-nearest-neighbor"></a> ANN (approximate nearest neighbor)</h1>
<p>Common ann algorithms: trees, hashes, graphs</p>
<h2 id="tree-based-kd-tree"><a class="markdownIt-Anchor" href="#tree-based-kd-tree"></a> Tree-based: Kd-tree</h2>
<h2 id="hash-based-lsh"><a class="markdownIt-Anchor" href="#hash-based-lsh"></a> Hash-based: LSH</h2>
<h2 id="graph-based-hnsw"><a class="markdownIt-Anchor" href="#graph-based-hnsw"></a> Graph-based: HNSW</h2>
<blockquote>
<p>Ref: <a target="_blank" rel="noopener" href="https://towardsdatascience.com/similarity-search-part-4-hierarchical-navigable-small-world-hnsw-2aad4fe87d37#:~:text=Hierarchical%20Navigable%20Small%20World%20(HNSW)%20is%20a%20state%2Dof,approximate%20search%20of%20nearest%20neighbours">Similarity Search</a></p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/2023/08/21/ml-other-2/hnsw1.jpg" alt="" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Graph Search</td>
</tr>
</tbody>
</table>
<p>Intrinsic search: start with A, and then iterate all its neighbors to find the nearest one to query. Then move to the nearest neighbor. Repeat this process until there is no neighbor nodes that are closer than the current node. The current node is returned as the result.</p>
<p>Questions:</p>
<ol>
<li>What if there’s some nodes that have no neighbors?</li>
<li>If we want to find the nearest 2 nodes for query, and these 2 nodes are not connected, then we need to run the whole graph twice, which costs lots of resources.</li>
<li>How to build the graph? Does node <code>G</code> really need those neighbors?</li>
</ol>
<p>Answers:</p>
<ol>
<li>When building graph, make sure that every node has at least 1 neighbor.</li>
<li>When building graph, make sure that if 2 nodes are close enough, they must have an edge.</li>
<li>Reduce the number of neighbor as much as possible.</li>
</ol>
<p>How to build a graph, see NSW method.</p>
<h3 id="nsw"><a class="markdownIt-Anchor" href="#nsw"></a> NSW</h3>
<p>In order to build a graph, firstly shuffle data points and then insert the nodes one by one.</p>
<p>When inserting a new node, link it with nearest <code>M</code> nodes.</p>
<p>Long-range edges will likely occur at the beginning phase of the graph construction.</p>
<h3 id="hnsw"><a class="markdownIt-Anchor" href="#hnsw"></a> HNSW</h3>
<table>
<thead>
<tr>
<th style="text-align:center"><img src="/2023/08/21/ml-other-2/hnsw2.png" alt="" /></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">HNSW Search</td>
</tr>
</tbody>
</table>
<p><strong>Build Graph</strong>: Use a parameter to decide whether this node needs to be inserted into certain layer. And the node is inserted into its insertion layer and every layer below it.</p>
<p><strong>Search Graph</strong>: Start with top layer, find the nearest node greedily, and then go to lower layer. Repeat until the 0 layer.</p>
<h1 id="k-fold-cross-validation"><a class="markdownIt-Anchor" href="#k-fold-cross-validation"></a> K-Fold Cross Validation</h1>
<p><mark>@TODO</mark></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/machine-learning/" rel="tag"># machine learning</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/08/09/ml-nonlinear-models/" rel="prev" title="Non-linear models">
                  <i class="fa fa-chevron-left"></i> Non-linear models
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/08/26/dl-models/" rel="next" title="Deep Learning Models">
                  Deep Learning Models <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">KellyH</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  
  <script async src="/js/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha256-55Ddc47WvWTK5vYVejnAuSK7USJaL7FQXrzQ4HiQ1WY=" crossorigin="anonymous">



</body>
</html>
